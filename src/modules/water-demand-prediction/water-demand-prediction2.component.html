@let chartOptions =
  {
    barThickness: "flex",
    responsive: true,
    maintainAspectRatio: false,
    elements: {
      line: {
        tension: 0.1,
      },
    },
    scales: {
      y: {
        stacked: false,
        title: {
          display: true,
          text: "m^3",
        },
        grid: {
          display: true,
          color: "#000000",
          lineWidth: 0.4,
        },
      },
      x: {
        title: {
          display: true,
          text: "water-demand-prediction.graph.legend.time" | translate,
        },
        grid: {
          display: false,
          color: "#000000",
          lineWidth: 0.4,
        },
        ticks: {
          callback: xTicks(chartResolution(), lang()),
        },
      },
    },
    plugins: {
      legend: {
        labels: {
          generateLabels: legendLabel(lang()),
        },
      },
    },
  };

<div class="outer-layout box is-fullheight">
  <div class="inner-layout is-fullheight">
    <div resolution-select class="cell">
      <div class="buttons are-small has-addons is-right">
        @for (resolution of Service.RESOLUTIONS; track resolution) {
          <button
            class="button"
            [class.is-active]="chartResolution() == resolution"
            (click)="chartResolution.set(resolution)"
            translate
          >
            water-demand-prediction.resolution.{{ resolution }}
          </button>
        }
      </div>
    </div>
    <div normal-smartmeter-chart class="cell">
      <canvas
        baseChart
        type="bar"
        class="is-fullheight is-fullwidth"
        [options]="chartOptions"
        [labels]="$any(chartLabels())"
        [datasets]="$any(chartDatasets.historic[chartResolution()]())"
      ></canvas>
    </div>
    <div configure-normal-smartmeter class="cell">
      <div
        class="buttons are-medium is-centered"
        style="--bulma-control-size: 0.9rem"
      >
        <button class="button is-danger" (click)="clearSmartmeterDataset()">
          <span translate="water-demand-prediction.delete.normal"></span>
          <span class="icon is-large">
            <ng-icon size="1.2em" name="remixDeleteBin2Line"></ng-icon>
          </span>
        </button>
        <button class="button is-primary">
          <span>Train selected model</span>
          <span class="icon is-large">
            <ng-icon size="1.2em" name="remixPingPongLine"></ng-icon>
          </span>
        </button>
        <button
          class="button is-info"
          [disabled]="!smartmeter()"
          (click)="pushSmartmeterDataset()"
        >
          <span translate>Add to Graph</span>
          <span class="icon is-large">
            <ng-icon size="1.2em" name="remixArrowUpDoubleFill"></ng-icon>
          </span>
        </button>
      </div>
    </div>
    <div select-normal-smartmeter class="cell">
      <div
        class="buttons are-small is-centered"
        style="--bulma-control-size: 0.8rem; gap: 0.5rem"
      >
        <dropdown
          menuName="water-demand-prediction.choice.resolution"
          [changeMenuName]="true"
          [is-up]="true"
          [options]="options.resolution"
          kind="hover"
          [(choice)]="choices.resolution"
        ></dropdown>
        <dropdown
          menuName="water-demand-prediction.choice.timeframe"
          [changeMenuName]="true"
          [is-up]="true"
          [options]="options.timeframe()"
          kind="hover"
          [(choice)]="choices.timeframe"
        ></dropdown>
        <dropdown
          menuName="water-demand-prediction.choice.smartmeter"
          [changeMenuName]="true"
          [is-up]="true"
          [options]="options.smartmeter()"
          kind="hover"
          [(choice)]="choices.smartmeter"
        ></dropdown>
        <dropdown
          menuName="water-demand-prediction.choice.start-point"
          [changeMenuName]="true"
          [is-up]="true"
          [options]="options.startPoint"
          kind="hover"
          [(choice)]="choices.startPoint"
        ></dropdown>
        <dropdown
          menuName="water-demand-prediction.choice.weather"
          [changeMenuName]="true"
          [is-up]="true"
          [options]="options.weatherCapability"
          kind="hover"
          [(choice)]="choices.weatherCapability"
        ></dropdown>
        <dropdown
          menuName="water-demand-prediction.choice.weatherColumn"
          [changeMenuName]="true"
          [is-up]="true"
          [options]="options.weatherColumn()"
          [disabled]="options.weatherColumn() | empty"
          kind="hover"
          [(choice)]="choices.weatherColumn"
        ></dropdown>
      </div>
    </div>
    <div placeholder class="cell"></div>
    <div predicted-smartmeter-chart class="cell">
      <canvas
        baseChart
        type="bar"
        class="is-fullheight is-fullwidth"
        [options]="chartOptions"
      ></canvas>
    </div>
    <div select-predicted-smartmeter class="cell">
      <div class="buttons has-addons is-centered">
        <button class="button">del</button>
        <button class="button">train</button>
        <button class="button">show</button>
      </div>
    </div>
    <div predicted-smartmeter-results class="cell"></div>
  </div>
</div>
